var SecuPress={swal2Defaults:{confirmButtonText:SecuPressi18nScanner.confirmText,cancelButtonText:SecuPressi18nScanner.cancelText,type:"warning",allowOutsideClick:!0,customClass:"wpmedia-swal2 secupress-swal2"},swal2ConfirmDefaults:{showCancelButton:!0,closeOnConfirm:!1}};SecuPressi18nScanner.step=Number(SecuPressi18nScanner.step),jQuery(document).ready(function(a){function b(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return""}function c(a){wp.a11y&&wp.a11y.speak&&void 0!==a&&a&&wp.a11y.speak(a)}function d(){var b;m&&window.Chart&&SecuPressi18nChart&&(a.isEmptyObject(l)?(b=[{value:SecuPressi18nChart.good.value,color:"#26B3A9",highlight:"#2BCDC1",label:SecuPressi18nChart.good.text,status:"good"},{value:SecuPressi18nChart.bad.value,color:"#CB234F",highlight:"#F2295E",label:SecuPressi18nChart.bad.text,status:"bad"},{value:SecuPressi18nChart.warning.value,color:"#F7AB13",highlight:"#F1C40F",label:SecuPressi18nChart.warning.text,status:"warning"}],SecuPressi18nChart.notscannedyet.value&&b.push({value:SecuPressi18nChart.notscannedyet.value,color:"#5A626F",highlight:"#888888",label:SecuPressi18nChart.notscannedyet.text,status:"notscannedyet"}),a.each(m,function(a,c){var d=c.id;l[d]=new Chart(c.getContext("2d")).Doughnut(b,{animationEasing:"easeInOutQuart",showTooltips:!0,segmentShowStroke:!1,percentageInnerCutout:93,tooltipEvents:[]})})):a.each(m,function(a,b){var c=b.id;l[c].segments[0].value=SecuPressi18nChart.good.value,l[c].segments[1].value=SecuPressi18nChart.bad.value,l[c].segments[2].value=SecuPressi18nChart.warning.value,"undefined"!=typeof l[c].segments[3]&&(l[c].segments[3].value=SecuPressi18nChart.notscannedyet.value),l[c].update()}),SecuPressi18nChart.notscannedyet.value||a(".secupress-chart-legend .status-notscannedyet").remove())}function e(b){return b.each(function(){var b=a(this),c=this.nodeName.toLowerCase();"button"===c||"input"===c?b.attr({disabled:"disabled","aria-disabled":"true"}):b.addClass("disabled").attr("aria-disabled","true")}),b}function f(b){return b.each(function(){var b=a(this),c=this.nodeName.toLowerCase();"button"===c||"input"===c?b.removeAttr("disabled aria-disabled"):b.removeClass("disabled").removeAttr("aria-disabled")}),b}function g(a){var b=a.get(0).nodeName.toLowerCase();return"button"===b||"input"===b?a.prop("disabled"):void a.hasClass("disabled")}function h(){var b=a(".secupress-button-manual-fixit");b.find(".secupress-icon-shield").addClass("secupress-icon-check").removeClass("secupress-icon-shield"),a(".secupress-mf-content.fixing").removeClass("fixing"),b=b.add(".secupress-button-ignoreit"),f(b)}function i(b){m&&window.Chart&&(a(".secupress-chart-container .letter").replaceWith(b.letter),a(".secupress-score-text").html(b.text),a(".secupress-scan-infos .secupress-score").html(b.subtext),a("#wp-admin-bar-secupress").find(".letter").text(b.grade),a("#toplevel_page_"+SecuPressi18nScanner.pluginSlug+"_scanners").find(".update-count").text(b.bad).parent().attr("class",function(a,c){return c.replace(/count-\d+/,"count-"+b.bad)}),SecuPressi18nChart&&(SecuPressi18nChart.good.value=b.good,SecuPressi18nChart.bad.value=b.bad,SecuPressi18nChart.warning.value=b.warning,SecuPressi18nChart.notscannedyet.value=b.notscannedyet,d()))}function j(b){var c;1===SecuPressi18nScanner.step&&b?window.location.href.match(/(\?|&)step=1($|&)/)?window.location=window.location.href:window.location=window.location.href.replace("&step=0","")+"&step=1":2===SecuPressi18nScanner.step?window.location=window.location.href.replace(/(\?|&)step=2($|&)/,"$1step=3$2"):3===SecuPressi18nScanner.step&&(c=a(".secupress-manual-fix").not(".hide-if-js"),c.find(".secupress-button-manual-scanit").find(".secupress-icon-shield").addClass("secupress-icon-check").removeClass("secupress-icon-shield"),h(),c.find(".secupress-button-ignoreit").first().trigger("next.secupress"))}function k(b,c){var d;return"boolean"!=typeof c&&(c=!1),SecuPressi18nScanner.i18nNonce?(d={action:"secupress-get-scan-counters",_wpnonce:SecuPressi18nScanner.i18nNonce},void a.getJSON(ajaxurl,d).done(function(c){a.isPlainObject(c)&&c.success&&c.data&&(c.data.isBulk=b,i(c.data))}).always(function(){j(c)})):void j(c)}var l={},m=[];document.getElementById("status_chart")&&m.push(document.getElementById("status_chart")),document.getElementById("status_chart_mini")&&m.push(document.getElementById("status_chart_mini")),a(".secupress-score").find(".letter").hasClass("lA")&&"ok"!==b("secupresstweeted")&&a("#tweeterA").slideDown(),a("#tweeterA .secupress-button").on("click.secupress",function(){var b=new Date,c=b.getTime(),d=c+31104e6;b.setTime(d),document.cookie="secupresstweeted=ok; expires="+b.toGMTString()+"; path=/",a("#tweeterA").slideUp()}),function(a,b,c,d){function e(a,b,d,f){c.getJSON(a).done(function(g){return g.success?g.data&&(f.text(g.data+"%"),100!==g.data)?void e(a,b,d,f):void b.closest(".secupress-notice").fadeTo(100,0,function(){c(this).slideUp(100,function(){c(this).remove()})}):(d.replaceWith('<span class="secupress-error-notif">'+SecuPressi18nScanner.error+"</span>"),void f.remove())}).fail(function(){d.replaceWith('<span class="secupress-error-notif">'+SecuPressi18nScanner.error+"</span>"),f.remove()})}c(".secupress-centralize-blog-options").on("click.secupress keyup",function(a){var b,d,f,g;return!("keyup"===a.type&&!secupressIsSpaceOrEnterKey(a))&&(b=c(this),d=b.attr("href").replace("admin-post.php","admin-ajax.php"),f=c('<img src="'+SecuPressi18nScanner.spinnerUrl+'" alt="" class="secupress-spinner" />'),g=c('<span class="secupress-ajax-percent">0%</span>'),!b.hasClass("running")&&(b.addClass("running").parent().append(f).append(g).find(".secupress-error-notif").remove(),a.preventDefault(),void e(d,b,f,g)))})}(window,document,a),function(a,b,c,d){var e=c.propHooks.checked;c.propHooks.checked={set:function(a,b,f){var g;return g=d===e?a[f]=b:e(a,b,f),c(a).trigger("change.secupress"),g}},c(".secupress-sg-content .secupress-row-check").on("click",function(a){var b=c(this),d=b.closest(".secupress-scans-group").find(".secupress-row-check").filter(":visible:enabled").not(":checked");b.closest(".secupress-scans-group").find(".secupress-toggle-check").prop("checked",function(){return 0===d.length})}).on("change.secupress",function(a){var b,d,e=c(this);if(e.is(":visible:enabled")){if(b=c(".secupress-button-autofix"),e.is(":checked"))return void(b.first().hasClass("hidden")&&(b.next().addClass("hidden"),b.removeClass("hidden")));d=c(".secupress-sg-content .secupress-row-check").filter(":visible:enabled:checked"),d.length||b.first().hasClass("hidden")||(b.addClass("hidden"),b.next().removeClass("hidden"))}}).first().trigger("change.secupress"),c(".secupress-sg-header .secupress-toggle-check").on("click.wp-toggle-checkboxes",function(a){var b=c(this),d=b.closest(".secupress-scans-group"),e=b.prop("checked"),f=a.shiftKey||b.data("wp-toggle");d.children(".secupress-sg-header").find(".secupress-toggle-check").prop("checked",function(){var a=c(this);return!a.is(":hidden,:disabled")&&(f?!a.prop("checked"):!!e)}),d.children(".secupress-sg-content").find(".secupress-row-check").prop("checked",function(){return!f&&!!e})})}(window,document,a),m&&window.Chart&&(a(".secupress-scanners-header").hasClass("secupress-not-scanned-yet")||d()),function(a,b,c,d){var e=c(".secupress-scan-header-main .secupress-tabs-controls-list a"),f=e.filter('[href="#secupress-scan"]'),g=c(".secupress-scanners-header"),h=c(".secupress-heading").find(".secupress-last-scan-result"),i="secupress-tab-selected";f.on("click.secupress",function(){g.removeClass(i),h.off("click.secupress")}),e.not('[href="#secupress-scan"]').on("click.secupress",function(){g.addClass(i),h.on("click.secupress",function(){f.trigger("click.secupress")})})}(window,document,a),function(a,b,c,d){var e=c(".secupress-start-one-click-scan .secupress-button-scan");e.css("width",e.outerWidth()+5)}(window,document,jQuery),function(a,b,i,j){function l(){var a=i("#secupress-tests").find(".secupress-item-all").length;F.total=a}function m(a){var b,e=i(".secupress-introduce-first-scan"),f=i(".secupress-scanners-header"),g=a.closest(".secupress-not-scanned-yet").length,h=i(".secupress-progressbar-val"),j=i(".secupress-progress-val-txt"),k=2;f.addClass("secupress-scanning"),i(".secupress-scanned-total").text(F.total),b=setInterval(function(){var a=Object.keys(F.doingScan).length,l=F.total-a,m=Math.max(l/F.total*100,k);m=Math.round(Math.min(m,100)),h.css("width",m+"%"),j.text(m+"Â %"),i(".secupress-scanned-current").text(l),m>=100&&(c(SecuPressi18nScanner.a11y.scanEnded),clearInterval(b),g?e.slideUp(200,function(){i(".secupress-open-moreinfo").removeClass("secupress-activated"),i("#secupress-more-info").removeClass("secupress-open").hide(),i(".secupress-scan-header-main").css("display","flex").hide().slideDown(200,function(){i(".secupress-scanners-header.secupress-not-scanned-yet").removeClass("secupress-not-scanned-yet")}),d()}):f.removeClass("secupress-scanning"))},500)}function n(){var a=i(".secupress-step-content-header, #secupress-tests, .secupress-step-content-footer"),b=i("#secupress-spinner");a.spHide(),b.spFadeIn().removeClass("hidden"),c(SecuPressi18nScanner.a11y.bulkFixStart)}function o(a){var b=i("#secupress-latest").find(".secupress-reports-list");b.children(".secupress-empty").remove(),5===b.children("li").length?b.children("li:last").slideUp(250,function(){i(this).remove(),b.prepend(a).find("li.hidden").slideDown(250)}):b.prepend(a).find("li.hidden").slideDown(250)}function p(a){var b=a.match(/[&?]test=([^&]+)(?:$|&)/);return!!b&&b[1]}function q(a){return!(!a.success||!i.isPlainObject(a.data))&&!!(a.data.status&&a.data.class&&a.data.message)}function r(){return i.isEmptyObject(F.doingScan)&&i.isEmptyObject(F.doingFix)&&!F.delayedFixes.length}function s(a,b){a.find(".secupress-item-status .secupress-label").text(b)}function t(a){return 1===SecuPressi18nScanner.step&&(s(a,SecuPressi18nScanner.error),a.addClass("status-error"),!1)}function u(a,b){var c,d="status-error status-good status-bad status-warning status-notscannedyet status-cantfix";return q(a)?(c="status-"+a.data.class,d=d.replace(c,"").replace("  "," "),b.removeClass(d).addClass(c),1===SecuPressi18nScanner.step&&(s(b,a.data.status),b.find(".secupress-item-title").html(a.data.message)),!0):t(b)}function v(a,b,c,d){return a?void(F.doingScan[a]||(F.doingScan[a]=1,b.addClass("scanning").removeClass("status-error"),i.getJSON(c.replace("admin-post.php","admin-ajax.php")).done(function(e){delete F.doingScan[a],u(e,b)&&i("body").trigger("scanDone.secupress",[{test:a,href:c,isBulk:d,data:e.data}])}).fail(function(){delete F.doingScan[a],t(b)}).always(function(){b.removeClass("scanning"),r()&&i("body").trigger("allScanDone.secupress",[{isBulk:d}])}))):t(b)}function w(a){return a.hasClass("status-bad")&&!a.hasClass("not-fixable")}function x(a,b,c){a&&(F.doingFix[a]||w(b)&&(F.doingFix[a]=1,b.addClass("fixing").removeClass("status-error"),i.getJSON(c.replace("admin-post.php","admin-ajax.php")).done(function(b){delete F.doingFix[a],q(b)&&i("body").trigger("fixDone.secupress",[{test:a,href:c,data:b.data}])}).fail(function(){delete F.doingFix[a]}).always(function(){i.isEmptyObject(F.doingFix)&&!F.delayedFixes.length&&i("body").trigger("allFixDone.secupress")})))}function y(a){return i.isEmptyObject(F.doingFix)?(a.filter(".delayed-fix").each(function(){F.delayedFixes.push(this)}),a.not(".delayed-fix")):a}function z(){var a=F.delayedFixes.shift();i(a).trigger("bulkfix.secupress")}function A(){var a=i(".secupress-sg-content .secupress-row-check").filter(":checked").siblings(".secupress-fixit");a=y(a),a.length?a.trigger("bulkfix.secupress"):z()}function B(a){var b;return a=a.addClass("status-error").find(".secupress-ic-fix-actions"),b=a.next(".secupress-response-notice"),b.length&&secupressNotices.remove(b),b=secupressNotices.create({type:"bad",message:SecuPressi18nScanner.error}),a.after(b),c(SecuPressi18nScanner.error),h(),!1}function C(a,b){var c;return q(a)?(c=b.children("form.secupress-item-content"),a.data.form_contents=a.data.form_contents?a.data.form_contents:"",a.data.form_contents||c.find(".secupress-button-manual-fixit").remove(),c.children(".secupress-ic-desc").html(a.data.message),c.children(".secupress-ic-fix-actions").html(a.data.form_contents),!0):B(b)}function D(a){var b,c=i("#secupress-mf-content-"+a),d=c.children("form.secupress-item-content").serializeArray();return d?(b=c.removeClass("status-error").find(".secupress-response-notice"),b.length&&secupressNotices.remove(b),c.addClass("fixing").find(".secupress-button-manual-fixit .secupress-icon-check").addClass("secupress-icon-shield").removeClass("secupress-icon-check"),void i.post(ajaxurl,d,null,"json").done(function(b){C(b,c)?i("body").trigger("manualFixDone.secupress",[{test:a,data:b.data}]):B(c)}).fail(function(){B(c)})):B(c)}function E(a,b,c){a&&(b.addClass("scanning").find(".secupress-button-manual-scanit .secupress-icon-check").addClass("secupress-icon-shield").removeClass("secupress-icon-check"),i.getJSON(c.replace("admin-post.php","admin-ajax.php")).done(function(b){q(b)&&i("body").trigger("scanDone.secupress",[{test:a,href:c,isBulk:!1,data:b.data}])}).always(function(){b.removeClass("scanning"),i("body").trigger("allScanDone.secupress",[{isBulk:!1}])}))}var F={doingScan:{},doingFix:{},delayedFixes:[],total:0};l(),i("body").on("scanDone.secupress",function(a,b){i("#"+b.test);F.delayedFixes.length&&z()}),i("body").on("allScanDone.secupress",function(a,b){var c,d=i(".secupress-button-scan").last();d.length&&g(d)?(c={action:"secupress-update-oneclick-scan-date",_wpnonce:d.data("nonce")},i.getJSON(ajaxurl,c).done(function(a){i.isPlainObject(a)&&a.success&&a.data&&o(a.data)}).always(function(){f(i(".secupress-button-scan")),k(b.isBulk,!0)})):k(b.isBulk)}),i("body").on("fixDone.secupress",function(a,b){var c=i("#"+b.test),d=c.data("scan-url");v(b.test,c,d,!0)}),i("body").on("allFixDone.secupress",function(a){}),i("body").on("manualFixDone.secupress",function(a,b){var c=i("#secupress-mf-content-"+b.test),d=c.data("scan-url");v(b.test,c,d,!1)}),i("body").on("bulkscan.secupress",".secupress-scanit",function(a){var b,c,d,e;a.preventDefault(),b=i(this),c=b.attr("href"),d=p(c),e=b.closest(".secupress-item-"+d),v(d,e,c,!0)}),i("body").on("click.secupress scan.secupress keyup",".secupress-button-manual-scanit",function(a){var b,c,d,f;return!("keyup"===a.type&&!secupressIsSpaceOrEnterKey(a))&&(b=i(this),void(g(b)||(a.preventDefault(),c=b.attr("href"),d=p(c),f=i("#secupress-mf-content-"+d),e(b),E(d,f,c))))}),i("body").on("click.secupress bulkscan.secupress keyup",".secupress-button-scan",function(b){var c;return!("keyup"===b.type&&!secupressIsSpaceOrEnterKey(b))&&(4===SecuPressi18nScanner.step?(a.location=SecuPressi18nScanner.firstScanURL,!1):(c=i(this),void(g(c)||(b.preventDefault(),e(i(".secupress-button-scan")),i(".secupress-scanit").trigger("bulkscan.secupress"),m(c)))))}),i("body").on("bulkfix.secupress",".secupress-fixit",function(a){var b,c,d,e;a.preventDefault(),b=i(this),c=b.attr("href"),d=p(c),e=b.closest(".secupress-item-"+d),x(d,e,c)}),i("body").on("click.secupress bulkfix.secupress keyup",".secupress-button-autofix",function(a){var b;return!("keyup"===a.type&&!secupressIsSpaceOrEnterKey(a))&&(b=i(this),void(g(b)||(a.preventDefault(),e(i(".secupress-button-autofix")),A(),n())))}),i("body").on("submit.secupress manualfix.secupress","form.secupress-item-content",function(a){var b,c=i(this),d=c.find(".secupress-button-manual-fixit");a.preventDefault(),g(d)||(e(i(".secupress-button-manual-fixit, .secupress-button-ignoreit")),b=c.parent(".secupress-mf-content").attr("id").replace("secupress-mf-content-",""),D(b))}),i("body").on("click.secupress next.secupress keyup",".secupress-button-ignoreit",function(b){var c,d,e,f;return!("keyup"===b.type&&!secupressIsSpaceOrEnterKey(b))&&(c=i(this),!g(c)&&(d=i("."+c.attr("data-parent")),e=d.next(),e.length?(b.preventDefault(),d.addClass("hide-if-js"),e.removeClass("hide-if-js"),f=i(".step3-advanced-text").first().text(),f=Number(f)+1,void i(".step3-advanced-text").text(f)):(a.location=this.href,!1)))}),i(".secupress-item-all.autoscan .secupress-scanit").trigger("bulkscan.secupress"),SecuPressi18nScanner.firstOneClickScan&&r()&&i(".secupress-button-scan").last().trigger("bulkscan.secupress")}(window,document,a)});